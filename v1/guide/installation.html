

  <!DOCTYPE html>
  <html lang="en">

  <head>
    <title>
      Installation —  Keel </title>
    <meta charset="utf-8">
    <meta name="description" content="Fully automated, policy driven continuous deployment solution for Kubernetes">    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta property="og:type" content="article">
    <meta property="og:title" content="Installation —  Keel">
    <meta property="og:description" content="CLI, daemon or Kubernetes deployment installation instructions -  Keel">
    <meta property="og:image" content="https://keel.sh/images/logo.png ">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Installation — Web Relay">
    <meta name="twitter:description" content="Fully automated, policy driven continuous deployment solution for Kubernetes">
    <meta name="twitter:image" content="https://keel.sh/images/logo.png">

    <link rel="apple-touch-icon" sizes="57x57" href="/ /images/icons/apple-icon-57x57.png ">
    <link rel="apple-touch-icon" sizes="60x60" href="/ /images/icons/apple-icon-60x60.png ">
    <link rel="apple-touch-icon" sizes="72x72" href="/ /images/icons/apple-icon-72x72.png ">
    <link rel="apple-touch-icon" sizes="76x76" href="/ /images/icons/apple-icon-76x76.png ">
    <link rel="apple-touch-icon" sizes="114x114" href="/ /images/icons/apple-icon-114x114.png ">
    <link rel="apple-touch-icon" sizes="120x120" href="/ /images/icons/apple-icon-120x120.png ">
    <link rel="apple-touch-icon" sizes="144x144" href="/ /images/icons/apple-icon-144x144.png ">
    <link rel="apple-touch-icon" sizes="152x152" href="/ /images/icons/apple-icon-152x152.png ">
    <link rel="apple-touch-icon" sizes="180x180" href="/ /images/icons/apple-icon-180x180.png ">
    <link rel="icon" type="image/png" sizes="192x192" href="/ /images/icons/android-icon-192x192.png ">
    <link rel="icon" type="image/png" sizes="32x32" href="/ /images/icons/favicon-32x32.png ">
    <link rel="icon" type="image/png" sizes="96x96" href="/ /images/icons/favicon-96x96.png ">
    <link rel="icon" type="image/png" sizes="16x16" href="/ /images/icons/favicon-16x16.png ">
    <meta name="msapplication-TileImage" content="/images/icons/ms-icon-144x144.png">
    <link rel="icon" href="/images/logo.png" type="image/png">

    <meta name="msapplication-TileColor" content="#2979ff">
    <meta name="theme-color" content="#2979ff">

    <meta name="msapplication-config" content="browserconfig.xml">
    <link rel="manifest" href="/manifest.json">    

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Dosis:500&text=Vue.js' rel='stylesheet' type='text/css'>

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->      
    <script>window.PAGE_TYPE = "guide"</script>    

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-103394074-1', 'auto');
      ga('send', 'pageview');

    </script>    
  </head>

  <body class="docs">
    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>
    <div id="header">
  <a id="logo" href="/">
    <img src="/images/logo.png">
    <span>Keel</span>
  </a>
  <ul id="nav">
    <!-- <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
-->
<li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><ul>
      <li><a href="/v1/guide/" class="nav-link current">Guide</a></li>
      <!-- <li><a href="/v1/api/" class="nav-link">API</a></li> -->
      <li><a href="/v1/examples/" class="nav-link">Examples</a></li>
    </ul></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="mailto:info@webhookrelay.com" class="nav-link" rel="nofollow">Email</a></li>            
      <li><a href="https://github.com/keel-hq/keel/issues" class="nav-link" target="_blank" rel="noopener">Issue Tracker</a></li>            
    </ul></li>
    <li><h4>Tooling</h4></li>
    <li>
      <ul>        
        <li><a href="https://hub.docker.com/r/keelhq/keel/" class="nav-link" target="_blank" rel="noopener">Docker Image</a></li>
        
      </ul>
    </li>    
    <li><h4>News</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/keel_hq" class="nav-link" target="_blank" rel="noopener">Twitter</a></li>      
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/keel-hq" class="nav-link" target="_blank" rel="noopener">Official Repos</a></li>            
    </ul></li>
  </ul>
</li>

<!-- 
<li>
  <a href="/blog/" class="nav-link team">Blog</a>
</li>
 <li>
  <a href="/v1/guide/team.html" class="nav-link team">Team</a>
</li> -->
<li>
  <a class="nav-link team" target="_blank" href="https://github.com/keel-hq/keel">Github →</a>
</li>

  </ul>
</div>

      
        <div id="main" class="fix-sidebar">
          
                
  <div class="sidebar">
  <div class="sidebar-inner">
    <ul class="main-menu">
      <!-- <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
-->
<li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><ul>
      <li><a href="/v1/guide/" class="nav-link current">Guide</a></li>
      <!-- <li><a href="/v1/api/" class="nav-link">API</a></li> -->
      <li><a href="/v1/examples/" class="nav-link">Examples</a></li>
    </ul></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="mailto:info@webhookrelay.com" class="nav-link" rel="nofollow">Email</a></li>            
      <li><a href="https://github.com/keel-hq/keel/issues" class="nav-link" target="_blank" rel="noopener">Issue Tracker</a></li>            
    </ul></li>
    <li><h4>Tooling</h4></li>
    <li>
      <ul>        
        <li><a href="https://hub.docker.com/r/keelhq/keel/" class="nav-link" target="_blank" rel="noopener">Docker Image</a></li>
        
      </ul>
    </li>    
    <li><h4>News</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/keel_hq" class="nav-link" target="_blank" rel="noopener">Twitter</a></li>      
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/keel-hq" class="nav-link" target="_blank" rel="noopener">Official Repos</a></li>            
    </ul></li>
  </ul>
</li>

<!-- 
<li>
  <a href="/blog/" class="nav-link team">Blog</a>
</li>
 <li>
  <a href="/v1/guide/team.html" class="nav-link team">Team</a>
</li> -->
<li>
  <a class="nav-link team" target="_blank" href="https://github.com/keel-hq/keel">Github →</a>
</li>

    </ul>
    <div class="list">      
      <h2>
        Guide
        
          <select class="version-select">
            <option value="SELF" selected>1.x</option>
          </select>
        
      </h2>
      <ul class="menu-root">
  
    
    
      
        <li><h3>Essentials</h3></li>
      
      
      
      
      
      
   
    
    
    <li>
      <a href="/v1/guide/index.html" class="sidebar-link">Introduction</a>
    </li>
  
    
    
      
      
      
      
      
      
   
    
    
    <li>
      <a href="/v1/guide/installation.html" class="sidebar-link current">Installation</a>
    </li>
  
    
    
      
      
      
      
      
      
   
    
    
    <li>
      <a href="/v1/guide/quick-start.html" class="sidebar-link">Quick Start</a>
    </li>
  
    
    
      
      
        <li><h3>Advanced Configuration</h3></li>
      
      
      
      
      
   
    
    
    <li>
      <a href="/v1/guide/documentation.html" class="sidebar-link">Documentation</a>
    </li>
  
    
    
      
      
      
        <li><h3>Internals</h3></li>
      
      
      
      
   
    
    
    <li>
      <a href="/v1/guide/dev-providers.html" class="sidebar-link">Providers in Depth</a>
    </li>
  
    
    
      
      
      
      
      
      
   
    
    
    <li>
      <a href="/v1/guide/dev-triggers.html" class="sidebar-link">Adding new trigger types</a>
    </li>
  
  
</ul>

    </div>
  </div>
</div>


<div class="content guide with-sidebar installation-guide">
  
    
  
  
    <h1>Installation</h1>
  
  <p>Keel doesn’t need a database. Keel doesn’t need persistent disk. It gets all required information from your cluster. This makes it truly cloud-native and easy to deploy.</p>
<h2 id="Deploying-with-kubectl"><a href="#Deploying-with-kubectl" class="headerlink" title="Deploying with kubectl"></a>Deploying with kubectl</h2><p>Keel can run anywhere and will do its job as long as it can connect to your Kubernetes environment. Since you have (or plan to have) Kubernetes environment, this guide will show you how to deploy Keel inside your Kubernetes cluster.</p>
<h3 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h3><ul>
<li><strong>Kubernetes environment</strong> (easiest way to get Kubernetes up and running is probably <a href="https://cloud.google.com/container-engine/" target="_blank" rel="noopener">Google Container Engine</a> or <a href="https://docs.docker.com/docker-for-mac/kubernetes/" target="_blank" rel="noopener">Docker for Mac with Kubernetes</a></li>
<li><strong><a href="https://kubernetes.io/docs/user-guide/kubectl-overview/" target="_blank" rel="noopener">kubectl</a></strong>: Kubernetes client</li>
</ul>
<p class="tip">We assume that your kubectl can access Kubernetes environment. If you have multiple environments, you should use <strong>kubectl config use-context [your cluster]</strong> command.</p>

<p>Configuration sample files are available in Keel repository on GitHub <a href="https://github.com/rusenask/keel/tree/master/hack" target="_blank" rel="noopener">here</a> and <a href="https://github.com/keel-hq/keel/tree/master/deployment" target="_blank" rel="noopener">here</a>.</p>
<h3 id="Installing"><a href="#Installing" class="headerlink" title="Installing"></a>Installing</h3><p>You can find sample deployments in <a href="https://github.com/keel-hq/keel" target="_blank" rel="noopener">https://github.com/keel-hq/keel</a> repository under <code>deployments</code> directory. You can either clone<br>whole repository or just download that file. Edit settings (depending on your environment whether you want to use <a href="https://cloud.google.com/container-registry/" target="_blank" rel="noopener">Google Container Registry</a> PUBSUB) or notifications and create it. All configuration is done through environment variables.</p>
<p>Some available configuration options:</p>
<ul>
<li><strong>POLL</strong> - removing this environment variable will disable poll support.</li>
<li><strong>PUBSUB</strong>  and <strong>PROJECT_ID</strong> - environment variables to enable automated integration with <a href="https://cloud.google.com/container-registry/" target="_blank" rel="noopener">Google Container Registry</a>. Set PROJECT_ID to your google cloud project ID. </li>
<li><strong>WEBHOOK_ENDPOINT</strong> - provide an endpoint where Keel should send notifications.</li>
<li><strong>SLACK_TOKEN</strong> - provide Slack token where Keel should send notifications, more info on getting token in the <a href="https://get.slack.help/hc/en-us/articles/215770388-Create-and-regenerate-API-tokens" target="_blank" rel="noopener">docs</a>.</li>
<li><strong>HELM_PROVIDER</strong> - enable <a href="https://helm.sh/" target="_blank" rel="noopener">Helm</a> provider. </li>
</ul>
<p>Once you are happy with environment variables, create it:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl create -f deployment-rbac.yaml</span><br></pre></td></tr></table></figure>
<p>That’s it, to check whether it successfully started - check pods:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl -n keel get pods</span><br></pre></td></tr></table></figure>
<p>You should see something like this:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl -n keel get pods</span><br><span class="line">NAME                    READY     STATUS    RESTARTS   AGE</span><br><span class="line">keel-2732121452-k7sjc   1/1       Running   0          14s</span><br></pre></td></tr></table></figure>
<h3 id="Uninstalling-Keel"><a href="#Uninstalling-Keel" class="headerlink" title="Uninstalling Keel"></a>Uninstalling Keel</h3><p>To remove Keel from your system, simply use existing deployment file:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl delete -f deployment-rbac.yaml</span><br></pre></td></tr></table></figure>
<p>Or delete the namespace.</p>
<h2 id="Deploying-with-Helm"><a href="#Deploying-with-Helm" class="headerlink" title="Deploying with Helm"></a>Deploying with Helm</h2><p>Helm chart is available on <a href="https://kubeapps.com/charts/stable/keel" target="_blank" rel="noopener">KubeApps</a> stable charts and   <a href="https://github.com/keel-hq/keel/tree/master/chart/keel" target="_blank" rel="noopener">Github here</a>.</p>
<h3 id="Installing-the-Chart-with-Kubernetes-provider-support"><a href="#Installing-the-Chart-with-Kubernetes-provider-support" class="headerlink" title="Installing the Chart with Kubernetes provider support"></a>Installing the Chart with Kubernetes provider support</h3><p>Docker image <em>polling</em> and <em>Kubernetes</em> provider are set by default, then Kubernetes <em>deployments</em> can be upgraded when new Docker image is available:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">helm repo up</span><br><span class="line">helm upgrade --install keel stable/keel</span><br></pre></td></tr></table></figure>
<p>If you want to install the Chart with Helm provider support:</p>
<p>Docker image <em>polling</em> is set by default, but we need to enable <em>Helm provider</em> support, then Helm <em>releases</em> can be upgraded when new Docker image is available:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">helm upgrade --install keel stable/keel --<span class="built_in">set</span> helmProvider.enabled=<span class="string">"true"</span></span><br></pre></td></tr></table></figure>
<h3 id="Setting-up-Helm-release-to-be-automatically-updated-by-Keel"><a href="#Setting-up-Helm-release-to-be-automatically-updated-by-Keel" class="headerlink" title="Setting up Helm release to be automatically updated by Keel"></a>Setting up Helm release to be automatically updated by Keel</h3><p>Add the following to your app’s <code>values.yaml</code> file and do <code>helm upgrade ...</code>:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">keel:</span></span><br><span class="line">  <span class="comment"># keel policy (all/major/minor/patch/force)</span></span><br><span class="line"><span class="attr">  policy:</span> <span class="string">all</span></span><br><span class="line">  <span class="comment"># trigger type, defaults to events such as pubsub, webhooks</span></span><br><span class="line"><span class="attr">  trigger:</span> <span class="string">poll</span></span><br><span class="line">  <span class="comment"># polling schedule</span></span><br><span class="line"><span class="attr">  pollSchedule:</span> <span class="string">"@every 3m"</span></span><br><span class="line">  <span class="comment"># images to track and update</span></span><br><span class="line"><span class="attr">  images:</span></span><br><span class="line"><span class="attr">    - repository:</span> <span class="string">image.repository</span> <span class="comment"># it must be the same names as your app's values</span></span><br><span class="line"><span class="attr">      tag:</span> <span class="string">image.tag</span> <span class="comment"># it must be the same names as your app's values</span></span><br></pre></td></tr></table></figure>
<p>The same can be applied with <code>--set</code> flag without using <code>values.yaml</code> file:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">helm upgrade --install whd webhookdemo --reuse-values \</span><br><span class="line">  --<span class="built_in">set</span> keel.policy=<span class="string">"all"</span>,keel.trigger=<span class="string">"poll"</span>,keel.pollSchedule=<span class="string">"@every 3m"</span> \</span><br><span class="line">  --<span class="built_in">set</span> keel.images[0].repository=<span class="string">"image.repository"</span> \</span><br><span class="line">  --<span class="built_in">set</span> keel.images[0].tag=<span class="string">"image.tag"</span></span><br></pre></td></tr></table></figure>
<p>You can read in more details about supported policies, triggers and etc in the <a href="/v1/guide/documentation.html">docs</a>.</p>
<p>Also you should check the <a href="https://github.com/webhookrelay/webhook-demo" target="_blank" rel="noopener">Webhook demo app</a> and it’s chart to have more clear<br>idea how to set automatic updates.</p>
<h3 id="Uninstalling-the-Chart"><a href="#Uninstalling-the-Chart" class="headerlink" title="Uninstalling the Chart"></a>Uninstalling the Chart</h3><p>To uninstall/delete the <code>keel</code> deployment:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">helm delete keel</span><br></pre></td></tr></table></figure>
<p>The command removes all the Kubernetes components associated with the chart and deletes the release.</p>
<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><p>The following table lists has the main configurable parameters (polling, triggers, notifications, service) of the <em>Keel</em> chart and they apply to both Kubernetes and Helm providers:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>polling.enabled</td>
<td>Docker registries polling</td>
<td><code>true</code></td>
</tr>
<tr>
<td>helmProvider.enabled</td>
<td>Enable/disable Helm provider</td>
<td><code>false</code></td>
</tr>
<tr>
<td>gcr.enabled</td>
<td>Enable/disable GCR Registry</td>
<td><code>false</code></td>
</tr>
<tr>
<td>gcr.projectID</td>
<td>GCP Project ID GCR belongs to</td>
<td></td>
</tr>
<tr>
<td>gcr.pubsub.enabled</td>
<td>Enable/disable GCP Pub/Sub trigger</td>
<td><code>false</code></td>
</tr>
<tr>
<td>webhook.enabled</td>
<td>Enable/disable Webhook Notification</td>
<td><code>false</code></td>
</tr>
<tr>
<td>webhook.endpoint</td>
<td>Remote webhook endpoint</td>
<td></td>
</tr>
<tr>
<td>slack.enabled</td>
<td>Enable/disable Slack Notification</td>
<td><code>false</code></td>
</tr>
<tr>
<td>slack.token</td>
<td>Slack token</td>
<td></td>
</tr>
<tr>
<td>slack.channel</td>
<td>Slack channel</td>
<td></td>
</tr>
<tr>
<td>service.enable</td>
<td>Enable/disable Keel service</td>
<td><code>false</code></td>
</tr>
<tr>
<td>service.type</td>
<td>Keel service type</td>
<td><code>LoadBalancer</code></td>
</tr>
<tr>
<td>service.externalPort</td>
<td>Keel service port</td>
<td><code>9300</code></td>
</tr>
<tr>
<td>webhookRelay.enabled</td>
<td>Enable/disable WebhookRelay integration</td>
<td><code>false</code></td>
</tr>
<tr>
<td>webhookRelay.key</td>
<td>WebhookRelay key</td>
<td></td>
</tr>
<tr>
<td>webhookRelay.secret</td>
<td>WebhookRelay secret</td>
<td></td>
</tr>
<tr>
<td>webhookRelay.bucket</td>
<td>WebhookRelay bucket</td>
</tr>
</tbody>
</table>
<p>Specify each parameter using the <code>--set key=value[,key=value]</code> argument to <code>helm install</code>.</p>
<p>Alternatively, a YAML file that specifies the values for the above parameters can be provided while installing the chart. For example,</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">helm install --name keel -f values.yaml stable/keel</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Tip</strong>: You can use the default <em>values.yaml</em>.</p>
</blockquote>

  
    <div class="guide-links">
      
        <span>← <a href="/v1/guide/index.html">Introduction</a></span>
      
      
        <span style="float: right;"><a href="/v1/guide/quick-start.html">Quick Start</a> →</span>
      
    </div>
    
  <div class="footer">  
    Caught a mistake or want to contribute to the documentation?
    <a href="https://github.com/keel-hq/keel-website/blob/master/src/v1/guide/installation.md" target="_blank">
      Edit this page on GitHub!
    </a>
  </div>
</div>

                  
        </div>
        <script src="/js/smooth-scroll.min.js"></script>
                      

      <!-- main custom script for sidebars, version selects etc. -->
      <script src="/js/css.escape.js"></script>
      <script src="/js/jquery.min.js"></script>
      <script src="/js/common.js"></script>                          
        
      <!-- fastclick -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
      <script>
        document.addEventListener('DOMContentLoaded', function () {
          FastClick.attach(document.body)
        }, false)
      </script>
  </body>

  </html>